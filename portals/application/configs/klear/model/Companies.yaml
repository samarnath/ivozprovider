#include ../conf.d/recordingHelp.yaml

production:
  class: \IvozProvider\Model\Companies
  entity: Ivoz\Domain\Model\Company\Company
  fields:
    id:
      title: ngettext('Id', 'Ids', 1)
      required: false
      readonly: true
    brand:
      title: _('Brand')
      type: select
      required: true
      source:
        data: mapper
        config:
#          mapperName: \IvozProvider\Mapper\Sql\Brands
          entity: \Ivoz\Domain\Model\Brand\Brand
          fieldName:
            fields:
              - name
            template: '%name%'
          order:
            Brand.name: asc
    name:
      title: ngettext('Name', 'Names', 1)
      type: text
      trim: both
      required: true
      default: true
    domainUsers:
      title: _('SIP domain')
      type: text
      trim: both
      maxLength: 190
      required: true
    nif:
      title: _('Nif')
      type: text
      trim: both
      required: true
    defaultTimezone:
      title: _('Default timezone')
      type: select
      defaultValue: 145
      required: true
      source:
        data: mapper
        config:
#          mapperName: \IvozProvider\Mapper\Sql\Timezones
          entity: \Ivoz\Domain\Model\Timezone\Timezone
          fieldName:
            fields:
              - tz
            template: '%tz%'
          order:
            Timezone.tz: asc
    musicOnHold:
      title: _('Music on hold')
      type: select
      source:
        data: mapper
        config:
#          mapperName: \IvozProvider\Mapper\Sql\MusicOnHold
          entity: \Ivoz\Domain\Model\MusicOnHold\MusicOnHold
          filterclass: IvozProvider_Klear_Filter_Company
          fieldName:
            fields:
              - name
            template: '%name%'
          order:
            MusicOnHold.name: asc
        'null': _("Unassigned")
    applicationServer:
      title: _('Application server id')
      type: select
      source:
        data: mapper
        config:
#          mapperName: \IvozProvider\Mapper\Sql\ApplicationServers
          entity: \Ivoz\Domain\Model\ApplicationServer\ApplicationServer
          fieldName:
            fields:
              - name
            template: '%name%'
          order:
            ApplicationServer.name: asc
        'null': _("Dispatch to any AS")
    externalMaxCalls:
      title: _('External max call')
      type: number
      defaultValue: 0
      source:
        control: Spinner
    postalAddress:
      title: _('Postal address')
      type: text
      trim: both
      required: true
      maxLength: 255
    postalCode:
      title: ngettext('Postal code', 'Postal codes', 1)
      type: text
      trim: both
      required: true
      maxLength: 10
    town:
      title: _('Town')
      type: text
      trim: both
      required: true
      maxLength: 255
    province:
      title: ngettext('Province', 'Provinces', 1)
      type: text
      trim: both
      required: true
      maxLength: 255
    country:
      title: ngettext('Country', 'Countries', 1)
      type: text
      trim: both
      required: true
      maxLength: 255
    outboundPrefix:
      title: _('Outbound prefix')
      type: text
      trim: both
    country:
      title: _('Country code')
      type: select
      defaultValue: 70
      required: true
      source:
        data: mapper
        config:
#          mapperName: \IvozProvider\Mapper\Sql\Countries
          entity: \Ivoz\Domain\Model\Country\Country
          fieldName:
            fields:
              - name
              - callingCode
            template: '%name% (+%callingCode%)'
          order:
            Country.code: asc
        'null': _("Unassigned")
    areaCode:
      title: _('Areacode')
      type: text
      maxLength: 10
      info:
        type: box
        position: left
        icon: help
        text: _("Default Area code for users in this company")
        label: _("Need help?")
    outgoingDDI:
      title: _('Outgoing DDI')
      type: select
      source:
        data: mapper
        config:
#          mapperName: \IvozProvider\Mapper\Sql\DDIs
          entity: \Ivoz\Domain\Model\DDI\DDI
          filterClass: IvozProvider_Klear_Filter_OutgoingDDI
          fieldName:
            fields:
              - ddie164
            template: '+%ddie164%'
          order:
            DDI.ddie164: asc
        'null': _("Unassigned")
      info:
        type: box
        position: left
        icon: help
        text: _("Default outgoing DDI. This can be overriden in caller's edit screen.")
        label: _("Need help?")
    language:
      title: _('Language')
      type: select
      defaultValue: 1
      source:
        data: mapper
        config:
#          mapperName: \IvozProvider\Mapper\Sql\Languages
          entity: \Ivoz\Domain\Model\Language\Language
          fieldName:
            fields:
              - name
            template: '%name%'
          order:
            Language.name: asc
    mediaRelaySets:
      title: _('Media relay Set')
      type: select
      source:
        data: mapper
        config:
#          mapperName: \IvozProvider\Mapper\Sql\MediaRelaySets
          entity: \Ivoz\Domain\Model\MediaRelaySet\MediaRelaySet
          fieldName:
            fields:
              - name
            template: '%name%'
          order:
            MediaRelaySet.name: asc
    ipFilter:
      title: _('Filter by IP address')
      type: select
      defaultValue: 1
      source:
        data: inline
        values:
          '0':
            title: _("No")
          '1':
            title: _("Yes")
      info:
        type: box
        position: left
        icon: help
        text: _("Add IPs or network if enabled. Otherwise all calls will be rejected.")
        label: _("Need help?")
    onDemandRecord:
      title: _('On-demand call recording')
      type: select
      defaultValue: 0
      source:
        data: inline
        values:
          '0':
            title: _("Disabled")
            visualFilter:
              show: []
              hide: ["onDemandRecordCode"]
          '1':
            title: _("Using BXFER or INFO")
            visualFilter:
              show: ["onDemandRecordCode"]
              hide: []
          '2':
            title: _("Using DTMFs (read WARNING)")
            visualFilter:
              show: ["onDemandRecordCode"]
              hide: []
      <<: *recordingHelp
    onDemandRecordCode:
      title: _('Code')
      type: text
      trim: both
      required: true
      maxLength: 3
      prefix: '<span class="asterisc">*</span>'
      pattern: '[0-9*]+'
    externallyExtraOpts:
      title: _('Externally rater custom options')
      type: textarea
    recordingsLimitMB:
      title: _("Max disk usage (in MB)")
      type: number
      source:
        control: Spinner
        min: 0
      info:
        type: box
        position: left
        icon: help
        text: _("Max disk usage in megabytes this company can use. When limit has been reached, oldest recordings will be removed. Leave empty to allow unlimited disk usage.")
        label: _("Need help?")
    recordingsDiskUsage:
      title: _('Disk usage')
      type: ghost
      source:
        class: IvozProvider_Klear_Ghost_Recordings
        method: getCompanyDiskUsage
    recordingsLimitEmail:
      title: _('Disk usage notification email')
      type: text
      maxLength: 250
      info:
        type: box
        position: left
        icon: help
        text: _("Email address that will be notified when 80% of the configured limit has been reached.")
        label: _("Need help?")
    FeaturesRelCompany:
      title: _('Features')
      type: multiselect
      source:
        data: mapper
        config:
          extraDataAttributes:
            feature: id
          relation: \Ivoz\Domain\Model\FeaturesRelCompany\FeaturesRelCompany
          relationProperty: company
          relatedProperty: feature
          related: \Ivoz\Domain\Model\Feature\Feature
          filterclass: IvozProvider_Klear_Filter_Features
          relatedFieldName:
            fields:
              - name
            template: '%name%'
          order: name
staging:
  _extends: production
testing:
  _extends: production
development:
  _extends: production
localdev:
  _extends: production
